<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>ì¸í”Œë£¨ì—”ì ì‹œêµ°êµ¬ë³„ ì˜ˆë°©ì ‘ì¢… í˜„í™© ë²„ë¸”ë§µ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    body{margin:0;font-family:"ë§‘ì€ ê³ ë”•",sans-serif;}
    #map{position:fixed;inset:0;}
    .legend{background:white;padding:8px;border-radius:6px;box-shadow:0 2px 6px rgba(0,0,0,0.15);font-size:13px;}
    .topbar{position:fixed;left:10px;top:10px;z-index:1200;}
  </style>
</head>
<body>
  <div class="topbar">
    <div class="legend">
      <b>ì¸í”Œë£¨ì—”ì ì‹œêµ°êµ¬ë³„ êµ­ê°€ì˜ˆë°©ì ‘ì¢… í˜„í™©</b><br>
      <small>ë²„ë¸” í¬ê¸° = ì ‘ì¢… í˜„í™© ê°’</small>
    </div>
  </div>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // ğŸ”¹ CSV ë°ì´í„°ë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”
    const csvData = `
ì‹œêµ°êµ¬ëª…,ê°’
ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬,12345
ì„œìš¸íŠ¹ë³„ì‹œ ì„œì´ˆêµ¬,8520
ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬,6700
ëŒ€êµ¬ê´‘ì—­ì‹œ ìˆ˜ì„±êµ¬,4900
ê´‘ì£¼ê´‘ì—­ì‹œ ë¶êµ¬,3100
ì „ë¼ë¶ë„ ì „ì£¼ì‹œ,7200
ì œì£¼íŠ¹ë³„ìì¹˜ë„ ì œì£¼ì‹œ,5800
`; // â† ì—¬ê¸°ì— ì „ì²´ CSV ë‚´ìš©ì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”

    // ğŸ”¹ ì „êµ­ ì‹œêµ°êµ¬ ì¤‘ì‹¬ì¢Œí‘œ DB (ìƒ˜í”Œ ì¼ë¶€, ì‹¤ì œëŠ” 250ì—¬ê°œ ì „ì²´ ì œê³µ í•„ìš”)
    const regionCenters = {
      "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬": [37.5172,127.0473],
      "ì„œìš¸íŠ¹ë³„ì‹œ ì„œì´ˆêµ¬": [37.4836,127.0327],
      "ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬": [37.5730,126.9794],
      "ì„œìš¸íŠ¹ë³„ì‹œ ì¤‘êµ¬": [37.5636,126.9976],
      "ë¶€ì‚°ê´‘ì—­ì‹œ í•´ìš´ëŒ€êµ¬": [35.1631,129.1635],
      "ë¶€ì‚°ê´‘ì—­ì‹œ ìˆ˜ì˜êµ¬": [35.1457,129.1130],
      "ëŒ€êµ¬ê´‘ì—­ì‹œ ìˆ˜ì„±êµ¬": [35.8580,128.6304],
      "ê´‘ì£¼ê´‘ì—­ì‹œ ë¶êµ¬": [35.1740,126.9116],
      "ì „ë¼ë¶ë„ ì „ì£¼ì‹œ": [35.8242,127.1479],
      "ì œì£¼íŠ¹ë³„ìì¹˜ë„ ì œì£¼ì‹œ": [33.4996,126.5312]
      // âš ï¸ ì—¬ê¸°ì— ì „êµ­ ëª¨ë“  ì‹œêµ°êµ¬ ì¢Œí‘œë¥¼ ì¶”ê°€í•´ì•¼ ì™„ì „ ë²„ì „ ì™„ì„±
    };

    // CSV íŒŒì‹±
    function parseCSV(text){
      const lines = text.trim().split(/\r?\n/);
      const rows = lines.slice(1).map(line=>{
        const [region, value] = line.split(",");
        return { region: region.trim(), value: Number(value) };
      });
      return rows;
    }

    const data = parseCSV(csvData);

    // ì§€ë„ ì´ˆê¸°í™”
    const map = L.map('map').setView([36.5,127.8],7);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
      attribution:'&copy; OpenStreetMap'
    }).addTo(map);

    const values = data.map(d=>d.value).filter(v=>!isNaN(v));
    const vmin = Math.min(...values);
    const vmax = Math.max(...values);

    function scaleRadius(v){
      if (vmin===vmax) return 12;
      return 5 + ((v-vmin)/(vmax-vmin))*30;
    }

    const layer = L.layerGroup().addTo(map);
    data.forEach(d=>{
      const coords = regionCenters[d.region];
      if (!coords){
        console.warn("ì¢Œí‘œ ì—†ìŒ:", d.region);
        return;
      }
      const r = scaleRadius(d.value);
      L.circleMarker(coords,{
        radius:r,
        color:'#1976d2',
        fillColor:'#42a5f5',
        fillOpacity:0.6,
        weight:1
      })
      .addTo(layer)
      .bindPopup(`<b>${d.region}</b><br>ê°’: ${d.value}`);
    });

    const bounds = layer.getBounds();
    if (bounds.isValid()) map.fitBounds(bounds.pad(0.2));

    // ë²”ë¡€
    const legend = L.control({position:'bottomright'});
    legend.onAdd = function(){
      const div = L.DomUtil.create('div','legend');
      div.innerHTML = `<b>ë²„ë¸” í¬ê¸°</b><br>ì‘ìŒ: ${vmin} ~ í¼: ${vmax}`;
      return div;
    };
    legend.addTo(map);
  </script>

  <div style="position:fixed; left:10px; bottom:10px; z-index:1200; font-size:12px; background:#fff;padding:6px;border-radius:6px;box-shadow:0 1px 6px rgba(0,0,0,0.1);">
    ì œê³µ: <a href="https://gptonline.ai/ko/" target="_blank">gptonline.ai/ko</a>
  </div>
</body>
</html>
